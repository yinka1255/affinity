var SimpleCounter=new Class({Implements:[Options,Events],options:{format:"{D} {H} {M} {S}",lang:{d:{single:"Day",plural:"Days"},h:{single:"Hour",plural:"Hours"},m:{single:"Minute",plural:"Minutes"},s:{single:"Second",plural:"Seconds"}},leadingZero:!0,"continue":!1,class_number:"number",class_word:"word"},time:{d:0,h:0,m:0,s:0},stopTime:{d:!1,h:!1,m:!1,s:!1},handle:null,container:null,countDown:!0,formats:{full:"<span class='number'>{number}</span> <span class='word'>{word}</span>",shrt:"<span class='number'>{number}</span>"},initialize:function(t,s,i){i.formats&&(this.formats=i.formats),this.setOptions(i),this.container=new Element("div",{"class":"counter_container"}).inject(document.id(t)),this.setTargetTime(s),this.setClock=this.setClock.bind(this),this.start()},setTargetTime:function(t){var s="date"==typeOf(t)?t/1e3:t;now=new Date/1e3,seconds=0,minutes=0,days=0,hours=0,s=(s-now).toInt(),this.countDown=s>0,0>s&&(s=-1*s),seconds=s%60,s-=seconds,s/=60,minutes=s%60,s-=minutes,s/=60,hours=s%24,s-=hours,days=s/24,this.stopTime.d=0===days,this.stopTime.h=0===hours,this.stopTime.m=0===minutes,this.stopTime.s=0===seconds,this.time={d:days,h:hours,m:minutes,s:seconds}},setClock:function(){this.countDown?this.decrementTime():this.incrementTime();var t=this.options.format,s=this.options.leadingZero,i=s&&this.time.s<10?"0"+this.time.s:this.time.s,e=s&&this.time.m<10?"0"+this.time.m:this.time.m,n=s&&this.time.h<10?"0"+this.time.h:this.time.h,h=s&&this.time.d<10?"0"+this.time.d:this.time.d;t=t.substitute({D:this.formats.full.substitute({number:h,word:this.options.lang.d[1==h?"single":"plural"]}),H:this.formats.full.substitute({number:n,word:this.options.lang.h[1==n?"single":"plural"]}),M:this.formats.full.substitute({number:e,word:this.options.lang.m[1==e?"single":"plural"]}),S:this.formats.full.substitute({number:i,word:this.options.lang.s[1==i?"single":"plural"]}),d:this.formats.shrt.substitute({number:h,word:this.options.lang.d[1==h?"single":"plural"]}),h:this.formats.shrt.substitute({number:n,word:this.options.lang.h[1==n?"single":"plural"]}),m:this.formats.shrt.substitute({number:e,word:this.options.lang.m[1==e?"single":"plural"]}),s:this.formats.shrt.substitute({number:i,word:this.options.lang.s[1==i?"single":"plural"]})}),this.container.set("html",t)},decrementTime:function(){this.time.s--,this.time.s<0&&(this.time.s=this.stopTime.d?0:59,this.stopTime.s||0!==this.time.s?this.time.m--:this.stopTime.s=!0,this.time.m<0&&(this.time.m=this.stopTime.h?0:59,this.stopTime.m||0!==this.time.m?this.time.h--:this.stopTime.m=!0,this.time.h<0&&(this.time.h=this.stopTime.d?0:23,this.stopTime.h||0!==this.time.h?this.time.d--:this.stopTime.h=!0,this.stopTime.d||0!==this.time.d||(this.stopTime.d=!0)))),this.stopTime.s&&(this.fireEvent("done"),this.options["continue"]?this.countDown=!1:this.stop())},incrementTime:function(){this.time.s++,this.time.s>59&&(this.time.s=0,this.time.m++,this.time.m>59&&(this.time.m=0,this.time.h++,this.time.h>23&&(this.time.h=0,this.time.d++)))},start:function(t){return this.stop(),t&&this.setTargetTime(t),this.setClock(),this.handle=this.setClock.periodical(1e3),this},stop:function(){return clearInterval(this.handle),this},toElement:function(){return this.container}});